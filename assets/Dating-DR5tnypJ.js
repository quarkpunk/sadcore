import{_ as S,r,v as F,c as y,d as h,A as H,C as V,n as A,i as E,w as D,j as x,b as q,p as U,D as G,x as I,E as J,e as m,g as T,F as K,h as Q,y as O,B as P,k as W}from"./main-DrkWV9n8.js";import{u as Z}from"./dating-CLmUXGJT.js";import{C as ee}from"./CardContent-CUOJ9CmK.js";import{M as te}from"./MobileHeader-D_64a7-1.js";import"./Chip-CHaf7zPd.js";import"./Image-DxUq8eBe.js";const ne={__name:"CardSwipe",props:{swipe:{type:Boolean,default:!0},swipeThreshold:{type:Number,default:.9},distanceThreshold:{type:Number,default:200},angleThreshold:{type:Number,default:30},rotationMultiplier:{type:Number,default:20},maxRotationAngle:{type:Number,default:50},clickDelay:{type:Number,default:230},moveThreshold:{type:Number,default:7}},emits:["swipe-left","swipe-right","click"],setup(p,{emit:f}){const e=p,u=f,o=r(!1),c=r(!1),k=r(null),l=r("idle"),d=r({x:0,y:0}),v=r({x:0,y:0}),a=r(0),s=r(null),b=r(0);let i=null,g=0;const L=F(()=>{if(!o.value&&!c.value)return{transform:"translate(0, 0) rotate(0deg)",transition:"transform 0.2s ease-out"};const t=v.value.x-d.value.x,n=v.value.y-d.value.y,w=Math.min(t*e.rotationMultiplier/500,e.maxRotationAngle);return o.value?{transform:`translate(${t}px, ${n}px) rotate(${w}deg)`,animation:"0.5s fade-out ease",pointerEvents:"none",opacity:0}:(b.value=Math.min(Math.abs(t)/e.distanceThreshold,1),{transform:`translate(${t}px, ${n}px) rotate(${w}deg)`,transition:"none"})});function X(){u(k.value)}function M(t){if(!e.swipe||o.value)return;const n=C(t);d.value=n,v.value=n,a.value=Date.now(),l.value="waiting",t.type==="touchstart"&&t.preventDefault(),i=setTimeout(()=>{l.value==="waiting"&&$()},e.clickDelay)}function B(t){if(!e.swipe||o.value)return;const n=C(t);v.value=n,l.value==="waiting"?Math.sqrt(Math.pow(n.x-d.value.x,2)+Math.pow(n.y-d.value.y,2))>e.moveThreshold&&(clearTimeout(i),$()):l.value==="dragging"&&Y()}function _(t){if(!e.swipe||o.value)return;const n=C(t);v.value=n,l.value==="waiting"?(clearTimeout(i),z(t)):l.value==="dragging"&&j(),N()}function R(){i&&clearTimeout(i),N()}function $(){l.value="dragging",c.value=!0,s.value=null}function Y(){const t=v.value.x-d.value.x;s.value=t>0?"right":"left"}function j(){const t=v.value.x-d.value.x,n=Date.now()-a.value,w=Math.abs(t)/n;(Math.abs(t)>e.distanceThreshold||w>e.swipeThreshold)&&(s.value=t>0?"right":"left",o.value=!0,k.value=s.value==="right"?"swipe-right":"swipe-left")}function z(t){const n=Date.now(),w=C(t);n-g<300||(g=n,u("click",w))}function N(){c.value=!1,l.value="idle",s.value=null,b.value=0}function C(t){if(t.type.includes("touch")){const n=t.touches?.[0]||t.changedTouches?.[0];return n?{x:n.clientX,y:n.clientY}:{x:0,y:0}}return{x:t.clientX,y:t.clientY}}return(t,n)=>(h(),y("div",{class:A(["card-swipe",{swiping:c.value}]),onAnimationend:X,onMousedownPassive:M,onTouchstartPassive:M,onMousemovePassive:B,onTouchmovePassive:B,onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:R,style:V(e.swipe?L.value:null)},[H(t.$slots,"default",{},void 0,!0)],38))}},ae=S(ne,[["__scopeId","data-v-2e5c74b3"]]),oe={__name:"CardDating",props:{user:Object,swipe:Boolean,done:Boolean,like:Boolean},emits:["open","close"],setup(p,{emit:f}){const e=f,u=p,o=r(!1);function c(){o.value=!0,e("open")}function k(){o.value=!1,e("close")}return(l,d)=>(h(),E(ae,{swipe:!o.value&&u.swipe,class:A(["card-dating",{open:!p.done&&o.value,like:p.done&&p.like,dislike:p.done&&!p.like}])},{default:D(()=>[x(ee,{user:u.user,open:o.value&&!u.done,onOpen:c,onClose:k},null,8,["user","open"])]),_:1},8,["swipe","class"]))}},se=S(oe,[["__scopeId","data-v-2f4c857f"]]),le={class:"col"},ie={key:0,class:"col flex",id:"noselect"},re={key:1,class:"dating-stack"},ue={key:2,class:"col flex",id:"noselect"},ce={__name:"Dating",setup(p){const f=q();U();const e=Z(),u=r(!1);function o(){u.value=!0,f.components.navbar.show=!1}function c(){u.value=!1,f.components.navbar.show=!0}function k(){e.likeCurrent()}function l(){e.dislikeCurrent()}function d(){c();const a=e.data[e.data.length-1];a.swipe=!1,a.like=!0,a.done=!0,setTimeout(e.likeCurrent,300)}function v(){c();const a=e.data[e.data.length-1];a.swipe=!1,a.like=!1,a.done=!0,setTimeout(e.dislikeCurrent,300)}return G(async()=>{e.filterLoad(),e.data.length<2&&await e.fetch()}),(a,s)=>{const b=J("Icon-Search-Normal");return h(),y("div",le,[x(te,{title:a.$t("pages.dating.title")},{default:D(()=>[x(b,{onClick:s[0]||(s[0]=i=>a.$router.push("/dating/filter")),width:20,height:20,color:"white",style:{margin:"auto"}})]),_:1},8,["title"]),m(f).state.isOnline?m(e).data.length>0?(h(),y("div",re,[(h(!0),y(K,null,Q(m(e).data,(i,g)=>I((h(),E(se,{style:{position:"absolute"},class:"flex",swipe:g==m(e).data.length-1||g==m(e).data.length-2,key:i.id,user:i,like:i.like,done:i.done,onOpen:o,onClose:c,onSwipeLeft:l,onSwipeRight:k},null,8,["swipe","user","like","done"])),[[O,g==m(e).data.length-1||g==m(e).data.length-2]])),128))])):(h(),y("div",ue,[...s[2]||(s[2]=[T("div",{style:{margin:"auto","text-align":"center",color:"var(--color-gray-500)"}},[T("p",null,"На этом пока что всё"),T("p",null,"Попробуйте позже")],-1)])])):(h(),y("div",ie,[...s[1]||(s[1]=[T("div",{style:{margin:"auto","text-align":"center",color:"var(--color-gray-500)"}},[T("p",null,"No network connection")],-1)])])),I(x(W,null,{default:D(()=>[x(P,{icon:"Icon-Sadcore",text:a.$t("button.dislike"),onClick:v,class:"flex"},null,8,["text"]),x(P,{icon:"Icon-Heart",text:a.$t("button.like"),onClick:d,class:"flex"},null,8,["text"])]),_:1},512),[[O,u.value&&!m(f).components.navbar.show&&m(f).state.isOnline]])])}}},ge=S(ce,[["__scopeId","data-v-07b00eb6"]]);export{ge as default};
