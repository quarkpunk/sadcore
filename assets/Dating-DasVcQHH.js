import{_ as S,r,D as j,c as k,o as h,H as q,J as F,q as L,j as A,E as C,b as _,y as V,z as J,K,L as U,w as I,M as G,d as m,a as b,F as Q,e as W,t as Z,s as O,B as P,N as ee}from"./main-DaUflbHC.js";import{u as te}from"./dating-D6GMvCbj.js";import{C as ne}from"./CardContent-Xg92B4gS.js";import{M as ae}from"./MobileHeader-BeskvPev.js";import"./Chip-DMbQ-2xr.js";const oe={__name:"CardSwipe",props:{swipe:{type:Boolean,default:!0},swipeThreshold:{type:Number,default:.9},distanceThreshold:{type:Number,default:200},angleThreshold:{type:Number,default:30},rotationMultiplier:{type:Number,default:20},maxRotationAngle:{type:Number,default:50},clickDelay:{type:Number,default:230},moveThreshold:{type:Number,default:7}},emits:["swipe-left","swipe-right","click"],setup(f,{emit:s}){const e=f,u=s,o=r(!1),c=r(!1),y=r(null),i=r("idle"),d=r({x:0,y:0}),v=r({x:0,y:0}),a=r(0),p=r(null),x=r(0);let l=null,g=0;const E=j(()=>{if(!o.value&&!c.value)return{transform:"translate(0, 0) rotate(0deg)",transition:"transform 0.2s ease-out"};const t=v.value.x-d.value.x,n=v.value.y-d.value.y,w=Math.min(t*e.rotationMultiplier/500,e.maxRotationAngle);return o.value?{transform:`translate(${t}px, ${n}px) rotate(${w}deg)`,animation:"0.5s fade-out ease",pointerEvents:"none",opacity:0}:(x.value=Math.min(Math.abs(t)/e.distanceThreshold,1),{transform:`translate(${t}px, ${n}px) rotate(${w}deg)`,transition:"none"})});function X(){u(y.value)}function M(t){if(!e.swipe||o.value)return;const n=T(t);d.value=n,v.value=n,a.value=Date.now(),i.value="waiting",t.type==="touchstart"&&t.preventDefault(),l=setTimeout(()=>{i.value==="waiting"&&B()},e.clickDelay)}function $(t){if(!e.swipe||o.value)return;const n=T(t);v.value=n,i.value==="waiting"?Math.sqrt(Math.pow(n.x-d.value.x,2)+Math.pow(n.y-d.value.y,2))>e.moveThreshold&&(clearTimeout(l),B()):i.value==="dragging"&&H()}function D(t){if(!e.swipe||o.value)return;const n=T(t);v.value=n,i.value==="waiting"?(clearTimeout(l),Y(t)):i.value==="dragging"&&R(),N()}function z(){l&&clearTimeout(l),N()}function B(){i.value="dragging",c.value=!0,p.value=null}function H(){const t=v.value.x-d.value.x;p.value=t>0?"right":"left"}function R(){const t=v.value.x-d.value.x,n=Date.now()-a.value,w=Math.abs(t)/n;(Math.abs(t)>e.distanceThreshold||w>e.swipeThreshold)&&(p.value=t>0?"right":"left",o.value=!0,y.value=p.value==="right"?"swipe-right":"swipe-left")}function Y(t){const n=Date.now(),w=T(t);n-g<300||(g=n,u("click",w))}function N(){c.value=!1,i.value="idle",p.value=null,x.value=0}function T(t){if(t.type.includes("touch")){const n=t.touches?.[0]||t.changedTouches?.[0];return n?{x:n.clientX,y:n.clientY}:{x:0,y:0}}return{x:t.clientX,y:t.clientY}}return(t,n)=>(h(),k("div",{class:L(["card-swipe",{swiping:c.value}]),onAnimationend:X,onMousedownPassive:M,onTouchstartPassive:M,onMousemovePassive:$,onTouchmovePassive:$,onMouseup:D,onMouseleave:D,onTouchend:D,onTouchcancel:z,style:F(e.swipe?E.value:null)},[q(t.$slots,"default",{},void 0,!0)],38))}},se=S(oe,[["__scopeId","data-v-2e5c74b3"]]),ie={__name:"CardDating",props:{user:Object,swipe:Boolean,done:Boolean,like:Boolean},emits:["open","close"],setup(f,{emit:s}){const e=s,u=f,o=r(!1);function c(){o.value=!0,e("open")}function y(){o.value=!1,e("close")}return(i,d)=>(h(),A(se,{swipe:!o.value&&u.swipe,class:L(["card-dating",{open:!f.done&&o.value,like:f.done&&f.like,dislike:f.done&&!f.like}])},{default:C(()=>[_(ne,{user:u.user,open:o.value&&!u.done,onOpen:c,onClose:y},null,8,["user","open"])]),_:1},8,["swipe","class"]))}},le=S(ie,[["__scopeId","data-v-b20546b2"]]),re={class:"col"},ue={key:0,class:"col flex",id:"noselect"},ce={key:1,class:"dating-stack"},de={key:2,class:"col flex",id:"noselect"},pe={style:{margin:"auto","text-align":"center",color:"var(--color-gray-500)"}},fe={style:{"white-space":"pre-wrap"}},ve={__name:"Dating",setup(f){const s=V();J();const e=te(),u=r(!1);function o(){u.value=!0,s.components.navbar.show=!1}function c(){u.value=!1,s.components.navbar.show=!0}function y(){e.likeCurrent()}function i(){e.dislikeCurrent()}function d(){c();const a=e.data[e.data.length-1];a.swipe=!1,a.like=!0,a.done=!0,setTimeout(e.likeCurrent,300)}function v(){c();const a=e.data[e.data.length-1];a.swipe=!1,a.like=!1,a.done=!0,setTimeout(e.dislikeCurrent,300)}return K(async()=>{if(s.components.navbar.show=!0,s.mode.mock){e.data=U();return}e.filterLoad(),e.data.length<2&&await e.fetch()}),(a,p)=>{const x=G("Icon-Search-Normal");return h(),k("div",re,[_(ae,{title:a.$t("pages.dating.title")},{default:C(()=>[_(x,{onClick:p[0]||(p[0]=l=>a.$router.push("/dating/filter")),width:20,height:20,color:"white",style:{margin:"auto"}})]),_:1},8,["title"]),m(s).state.isOnline?m(e).data.length>0?(h(),k("div",ce,[(h(!0),k(Q,null,W(m(e).data,(l,g)=>I((h(),A(le,{style:{position:"absolute"},class:"flex",swipe:g==m(e).data.length-1||g==m(e).data.length-2,key:l.id,user:l,like:l.like,done:l.done,onOpen:o,onClose:c,onSwipeLeft:i,onSwipeRight:y},null,8,["swipe","user","like","done"])),[[O,g==m(e).data.length-1||g==m(e).data.length-2]])),128))])):(h(),k("div",de,[b("div",pe,[b("p",fe,Z(a.$t("pages.dating.empty")),1)])])):(h(),k("div",ue,[...p[1]||(p[1]=[b("div",{style:{margin:"auto","text-align":"center",color:"var(--color-gray-500)"}},[b("p",null,"No network connection")],-1)])])),I(_(ee,null,{default:C(()=>[_(P,{icon:"Icon-Sadcore",text:a.$t("button.dislike"),onClick:v,class:"flex"},null,8,["text"]),_(P,{icon:"Icon-Heart",text:a.$t("button.like"),onClick:d,class:"flex"},null,8,["text"])]),_:1},512),[[O,u.value&&!m(s).components.navbar.show&&m(s).state.isOnline]])])}}},ke=S(ve,[["__scopeId","data-v-a1117e04"]]);export{ke as default};
