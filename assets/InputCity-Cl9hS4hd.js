import{_ as Ie,K as $,r as S,L as ye,J as Oe,c as k,d as P,f as Pe,F as Me,h as Le,X as Ce,A as ke,i as be,g as G,O as fe,j as Fe,E as Se,p as je,C as _e,P as Xe,q as Ve,z as We}from"./main-r-KjY38Z.js";import{I as ze}from"./InputModal-XoxieRGC.js";/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function he(r,t){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),a.push.apply(a,e)}return a}function _(r){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?he(Object(a),!0).forEach(function(e){Ge(r,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):he(Object(a)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(a,e))})}return r}function Ye(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function me(r,t){for(var a=0;a<t.length;a++){var e=t[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,we(e.key),e)}}function He(r,t,a){return t&&me(r.prototype,t),a&&me(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ge(r,t,a){return t=we(t),t in r?Object.defineProperty(r,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[t]=a,r}function X(){return X=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(r[e]=a[e])}return r},X.apply(this,arguments)}function Ne(r,t){if(typeof r!="object"||r===null)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var e=a.call(r,t);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function we(r){var t=Ne(r,"string");return typeof t=="symbol"?t:String(t)}var Te={exports:{}};(function(r){typeof window>"u"||(function(t){var a=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,e=t.Blob&&(function(){try{return!!new Blob}catch{return!1}})(),n=e&&t.Uint8Array&&(function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}})(),o=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,m=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,h=(e||o)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(c){var f,d,g,y,b,i,B,T,x;if(f=c.match(m),!f)throw new Error("invalid data URI");for(d=f[2]?f[1]:"text/plain"+(f[3]||";charset=US-ASCII"),g=!!f[4],y=c.slice(f[0].length),g?b=atob(y):b=decodeURIComponent(y),i=new ArrayBuffer(b.length),B=new Uint8Array(i),T=0;T<b.length;T+=1)B[T]=b.charCodeAt(T);return e?new Blob([n?B:i],{type:d}):(x=new o,x.append(i),x.getBlob(d))};t.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(c,f,d){var g=this;setTimeout(function(){d&&a.toDataURL&&h?c(h(g.toDataURL(f,d))):c(g.mozGetAsFile("blob",f))})}:a.toDataURL&&h&&(a.msToBlob?a.toBlob=function(c,f,d){var g=this;setTimeout(function(){(f&&f!=="image/png"||d)&&a.toDataURL&&h?c(h(g.toDataURL(f,d))):c(g.msToBlob(f))})}:a.toBlob=function(c,f,d){var g=this;setTimeout(function(){c(h(g.toDataURL(f,d)))})})),r.exports?r.exports=h:t.dataURLtoBlob=h})(window)})(Te);var ve=Te.exports,$e=function(t){return typeof Blob>"u"?!1:t instanceof Blob||Object.prototype.toString.call(t)==="[object Blob]"},de={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},qe=typeof window<"u"&&typeof window.document<"u",A=qe?window:{},V=function(t){return t>0&&t<1/0},Ke=Array.prototype.slice;function K(r){return Array.from?Array.from(r):Ke.call(r)}var Je=/^image\/.+$/;function q(r){return Je.test(r)}function Qe(r){var t=q(r)?r.substr(6):"";return t==="jpeg"&&(t="jpg"),".".concat(t)}var Be=String.fromCharCode;function Ze(r,t,a){var e="",n;for(a+=t,n=t;n<a;n+=1)e+=Be(r.getUint8(n));return e}var et=A.btoa;function ge(r,t){for(var a=[],e=8192,n=new Uint8Array(r);n.length>0;)a.push(Be.apply(null,K(n.subarray(0,e)))),n=n.subarray(e);return"data:".concat(t,";base64,").concat(et(a.join("")))}function tt(r){var t=new DataView(r),a;try{var e,n,o;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var m=t.byteLength,h=2;h+1<m;){if(t.getUint8(h)===255&&t.getUint8(h+1)===225){n=h;break}h+=1}if(n){var c=n+4,f=n+10;if(Ze(t,c,4)==="Exif"){var d=t.getUint16(f);if(e=d===18761,(e||d===19789)&&t.getUint16(f+2,e)===42){var g=t.getUint32(f+4,e);g>=8&&(o=f+g)}}}if(o){var y=t.getUint16(o,e),b,i;for(i=0;i<y;i+=1)if(b=o+i*12+2,t.getUint16(b,e)===274){b+=8,a=t.getUint16(b,e),t.setUint16(b,1,e);break}}}catch{a=1}return a}function at(r){var t=0,a=1,e=1;switch(r){case 2:a=-1;break;case 3:t=-180;break;case 4:e=-1;break;case 5:t=90,e=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:e}}var rt=/\.\d*(?:0|9){12}\d*$/;function pe(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return rt.test(r)?Math.round(r*t)/t:r}function F(r){var t=r.aspectRatio,a=r.height,e=r.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",o=V(e),m=V(a);if(o&&m){var h=a*t;(n==="contain"||n==="none")&&h>e||n==="cover"&&h<e?a=e/t:e=a*t}else o?a=e/t:m&&(e=a*t);return{width:e,height:a}}function nt(r){for(var t=K(new Uint8Array(r)),a=t.length,e=[],n=0;n+3<a;){var o=t[n],m=t[n+1];if(o===255&&m===218)break;if(o===255&&m===216)n+=2;else{var h=t[n+2]*256+t[n+3],c=n+h+2,f=t.slice(n,c);e.push(f),n=c}}return e.reduce(function(d,g){return g[0]===255&&g[1]===225?d.concat(g):d},[])}function it(r,t){var a=K(new Uint8Array(r));if(a[2]!==255||a[3]!==224)return r;var e=a[4]*256+a[5],n=[255,216].concat(t,a.slice(4+e));return new Uint8Array(n)}var ot=A.ArrayBuffer,N=A.FileReader,O=A.URL||A.webkitURL,lt=/\.\w+$/,st=A.Compressor,xe=(function(){function r(t,a){Ye(this,r),this.file=t,this.exif=[],this.image=new Image,this.options=_(_({},de),a),this.aborted=!1,this.result=null,this.init()}return He(r,[{key:"init",value:function(){var a=this,e=this.file,n=this.options;if(!$e(e)){this.fail(new Error("The first argument must be a File or Blob object."));return}var o=e.type;if(!q(o)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!O||!N){this.fail(new Error("The current browser does not support image compression."));return}ot||(n.checkOrientation=!1,n.retainExif=!1);var m=o==="image/jpeg",h=m&&n.checkOrientation,c=m&&n.retainExif;if(O&&!h&&!c)this.load({url:O.createObjectURL(e)});else{var f=new N;this.reader=f,f.onload=function(d){var g=d.target,y=g.result,b={},i=1;h&&(i=tt(y),i>1&&X(b,at(i))),c&&(a.exif=nt(y)),h||c?!O||i>1?b.url=ge(y,o):b.url=O.createObjectURL(e):b.url=y,a.load(b)},f.onabort=function(){a.fail(new Error("Aborted to read the image with FileReader."))},f.onerror=function(){a.fail(new Error("Failed to read the image with FileReader."))},f.onloadend=function(){a.reader=null},h||c?f.readAsArrayBuffer(e):f.readAsDataURL(e)}}},{key:"load",value:function(a){var e=this,n=this.file,o=this.image;o.onload=function(){e.draw(_(_({},a),{},{naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight}))},o.onabort=function(){e.fail(new Error("Aborted to load the image."))},o.onerror=function(){e.fail(new Error("Failed to load the image."))},A.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(A.navigator.userAgent)&&(o.crossOrigin="anonymous"),o.alt=n.name,o.src=a.url}},{key:"draw",value:function(a){var e=this,n=a.naturalWidth,o=a.naturalHeight,m=a.rotate,h=m===void 0?0:m,c=a.scaleX,f=c===void 0?1:c,d=a.scaleY,g=d===void 0?1:d,y=this.file,b=this.image,i=this.options,B=document.createElement("canvas"),T=B.getContext("2d"),x=Math.abs(h)%180===90,D=(i.resize==="contain"||i.resize==="cover")&&V(i.width)&&V(i.height),U=Math.max(i.maxWidth,0)||1/0,R=Math.max(i.maxHeight,0)||1/0,E=Math.max(i.minWidth,0)||0,I=Math.max(i.minHeight,0)||0,s=n/o,l=i.width,u=i.height;if(x){var v=[R,U];U=v[0],R=v[1];var w=[I,E];E=w[0],I=w[1];var p=[u,l];l=p[0],u=p[1]}D&&(s=l/u);var j=F({aspectRatio:s,width:U,height:R},"contain");U=j.width,R=j.height;var J=F({aspectRatio:s,width:E,height:I},"cover");if(E=J.width,I=J.height,D){var Q=F({aspectRatio:s,width:l,height:u},i.resize);l=Q.width,u=Q.height}else{var Z=F({aspectRatio:s,width:l,height:u}),ee=Z.width;l=ee===void 0?n:ee;var te=Z.height;u=te===void 0?o:te}l=Math.floor(pe(Math.min(Math.max(l,E),U))),u=Math.floor(pe(Math.min(Math.max(u,I),R)));var Re=-l/2,Ee=-u/2,Ae=l,Ue=u,W=[];if(D){var ae=0,re=0,z=n,Y=o,ne=F({aspectRatio:s,width:n,height:o},{contain:"cover",cover:"contain"}[i.resize]);z=ne.width,Y=ne.height,ae=(n-z)/2,re=(o-Y)/2,W.push(ae,re,z,Y)}if(W.push(Re,Ee,Ae,Ue),x){var ie=[u,l];l=ie[0],u=ie[1]}B.width=l,B.height=u,q(i.mimeType)||(i.mimeType=y.type);var oe="transparent";y.size>i.convertSize&&i.convertTypes.indexOf(i.mimeType)>=0&&(i.mimeType="image/jpeg");var le=i.mimeType==="image/jpeg";if(le&&(oe="#fff"),T.fillStyle=oe,T.fillRect(0,0,l,u),i.beforeDraw&&i.beforeDraw.call(this,T,B),!this.aborted&&(T.save(),T.translate(l/2,u/2),T.rotate(h*Math.PI/180),T.scale(f,g),T.drawImage.apply(T,[b].concat(W)),T.restore(),i.drew&&i.drew.call(this,T,B),!this.aborted)){var se=function(L){if(!e.aborted){var ue=function(C){return e.done({naturalWidth:n,naturalHeight:o,result:C})};if(L&&le&&i.retainExif&&e.exif&&e.exif.length>0){var ce=function(C){return ue(ve(ge(it(C,e.exif),i.mimeType)))};if(L.arrayBuffer)L.arrayBuffer().then(ce).catch(function(){e.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var M=new N;e.reader=M,M.onload=function(H){var C=H.target;ce(C.result)},M.onabort=function(){e.fail(new Error("Aborted to read the compressed image with FileReader."))},M.onerror=function(){e.fail(new Error("Failed to read the compressed image with FileReader."))},M.onloadend=function(){e.reader=null},M.readAsArrayBuffer(L)}}else ue(L)}};B.toBlob?B.toBlob(se,i.mimeType,i.quality):se(ve(B.toDataURL(i.mimeType,i.quality)))}}},{key:"done",value:function(a){var e=a.naturalWidth,n=a.naturalHeight,o=a.result,m=this.file,h=this.image,c=this.options;if(O&&h.src.indexOf("blob:")===0&&O.revokeObjectURL(h.src),o)if(c.strict&&!c.retainExif&&o.size>m.size&&c.mimeType===m.type&&!(c.width>e||c.height>n||c.minWidth>e||c.minHeight>n||c.maxWidth<e||c.maxHeight<n))o=m;else{var f=new Date;o.lastModified=f.getTime(),o.lastModifiedDate=f,o.name=m.name,o.name&&o.type!==m.type&&(o.name=o.name.replace(lt,Qe(o.type)))}else o=m;this.result=o,c.success&&c.success.call(this,o)}},{key:"fail",value:function(a){var e=this.options;if(e.error)e.error.call(this,a);else throw a}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=st,r}},{key:"setDefaults",value:function(a){X(de,a)}}]),r})();function De(r,t){const a=r.getImageData(0,0,t.width,t.height),e=a.data;for(let n=0;n<e.length;n+=4){const o=e[n],m=e[n+1],h=e[n+2],c=Math.round(o*.299+m*.587+h*.114);e[n]=c,e[n+1]=c,e[n+2]=c}r.putImageData(a,0,0)}function ut(r){return new Promise((t,a)=>{if(!r||!r.type.startsWith("image/")){a(new Error("type no image"));return}new xe(r,{resize:"cover",quality:.6,width:960,height:1280,mimeType:"image/jpeg",drew:De,success:e=>t(e),error:e=>a(e)})})}function ct(r){return new Promise((t,a)=>{if(!r||!r.type.startsWith("image/")){a(new Error("type no image"));return}new xe(r,{resize:"cover",quality:.5,width:128,height:170,mimeType:"image/jpeg",drew:De,success:e=>t(e),error:e=>a(e)})})}async function ft(r){try{const[t,a]=await Promise.all([ct(r),ut(r)]);return{smallImage:t,baseImage:a}}catch{return console.error("compressor: failed image compress"),null}}const ht=["id"],mt=["draggable","onDragstart","onDrop","onMousedown","onTouchstart","onTouchmove","onTouchend"],vt=["onClick"],dt={key:1,class:"empty"},gt=["onChange"],pt=["src"],yt={__name:"Gallery",props:$({disabled:Boolean},{modelValue:{},modelModifiers:{}}),emits:$(["loaded","delete","moved","error"],["update:modelValue"]),setup(r,{emit:t}){const a=S({show:!1,x:0,y:0,image:null}),e=ye(r,"modelValue"),n=t,o=r,m=Array(4).fill(null);e.value||(e.value=m),e.value&&e.value.forEach((s,l)=>{l<4&&(m[l]=s)});function h(s){e.value?.[s]&&(e.value[s]._local&&(URL.revokeObjectURL(e.value[s].base),URL.revokeObjectURL(e.value[s].small)),e.value[s]=null,n("delete",s))}async function c(s,l){const u=s.target.files[0];if(u)try{const{smallImage:v,baseImage:w}=await ft(u),p={index:l,id:"",base:URL.createObjectURL(w),small:URL.createObjectURL(v),_local:{base:w,small:v},_state:{success:!1,error:!1}};e.value[l]=p,s.target.value="",n("loaded",l)}catch{n("error",null)}}function f(s,l){const u=parseInt(s.dataTransfer.getData("itemId"));if(e.value[l]==null){e.value[l]=e.value[u],e.value[l].index=l,e.value[u]=null,n("moved",u,l);return}else{let v=e.value.slice(0);const w=v[u],p=v[l];v[l]=w,v[u]=p,v[l].index=l,v[u].index=u,e.value=v,n("moved",u,l)}}let d=0,g=0,y=null,b=null,i=!1;function B(s,l){const u=s.touches[0];d=u.clientX,g=u.clientY,i=!1;const v=document.elementFromPoint(u.clientX,u.clientY);v&&v.closest(".remove")||e.value[l]!==null&&(s.preventDefault(),s.stopImmediatePropagation(),b=setTimeout(()=>{const w=s.touches[0];if(!w)return;const p=Math.abs(w.clientX-d),j=Math.abs(w.clientY-g);p<=10&&j<=10&&(i=!0,y=l,a.value={show:!0,x:w.clientX,y:w.clientY,image:e.value[l].base})},400))}function T(s,l){if(!i){const u=s.touches[0],v=Math.abs(u.clientX-d),w=Math.abs(u.clientY-g);(v>10||w>10)&&(clearTimeout(b),i=!1);return}if(i&&y!==null){s.preventDefault();const u=s.touches[0];a.value.x=u.clientX,a.value.y=u.clientY}}function x(s,l){if(clearTimeout(b),!i)return;const u=s.changedTouches[0],v=document.elementFromPoint(u.clientX,u.clientY);if(a.value.show=!1,v&&v.closest(".rect")){const w=v.closest(".rect"),p=Array.from(document.querySelectorAll(".rect")).indexOf(w);p!==-1&&p!==y&&f({dataTransfer:{getData:()=>y.toString()}},p)}y=null,i=!1}let D=!1;function U(s,l){s.target.closest(".remove")||e.value[l]!==null&&(D=!0,y=l,s.clientX,s.clientY,a.value={show:!0,x:s.clientX,y:s.clientY,image:e.value[l].base},document.addEventListener("mousemove",R),document.addEventListener("mouseup",E),s.preventDefault())}function R(s){D&&(a.value.x=s.clientX,a.value.y=s.clientY)}function E(s){if(!D)return;D=!1,a.value.show=!1;const l=document.elementFromPoint(s.clientX,s.clientY);if(l&&l.closest(".rect")){const u=l.closest(".rect"),v=Array.from(document.querySelectorAll(".rect")).indexOf(u);v!==-1&&v!==y&&f({dataTransfer:{getData:()=>y.toString()}},v)}document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",E),y=null}function I(s,l){if(s.dataTransfer.setData("itemId",l),s.dataTransfer.setDragImage){const u=new fe;u.src=e.value[l].base,s.dataTransfer.setDragImage(u,0,0)}}return(s,l)=>{const u=Oe("Icon-Add");return P(),k("div",{class:je(["gallery",{disabled:o.disabled}]),id:o.disabled?"noevents":null},[(P(!0),k(Me,null,Le(e.value,(v,w)=>(P(),k("div",{key:v,class:"rect",draggable:e.value[w]!=null,onDragstart:p=>I(p,w),onDragover:l[0]||(l[0]=Ce(()=>{},["prevent"])),onDrop:p=>f(p,w),onMousedown:p=>U(p,w),onTouchstart:p=>B(p,w),onTouchmove:p=>T(p),onTouchend:p=>x(p)},[ke(G("div",{class:"remove",onClick:p=>h(w)},null,8,vt),[[_e,v]]),v?(P(),be(fe,{key:0,blur:"",src:v.base,placeholder:v.small,id:"noevents",style:{position:"absolute",width:"100%",height:"100%","border-radius":"15px"},cover:""},null,8,["src","placeholder"])):(P(),k("div",dt,[Fe(u,{color:"var(--color-gray-400)",style:{margin:"auto"},width:22,height:22}),G("input",{class:"loader",type:"file",onChange:p=>c(p,w),accept:"image/png, image/jpeg"},null,40,gt)]))],40,mt))),128)),a.value.show?(P(),k("div",{key:0,class:"drag-preview",style:Se({left:a.value.x+"px",top:a.value.y+"px"})},[G("img",{src:a.value.image,alt:"Preview"},null,8,pt)],4)):Pe("",!0)],10,ht)}}},Bt=Ie(yt,[["__scopeId","data-v-b3dd9a08"]]),xt={__name:"InputCity",props:$({textValue:String,textNotValue:{type:String,default:"Укажите город"},showButtonDelete:{type:Boolean,value:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const t=ye(r,"modelValue"),a=r,e=Xe(),n=Ve(),o=S(!1),m=S(""),h=S([]),c=S(null),f=We({get:()=>m.value,set:i=>{m.value=i,o.value=!1,clearTimeout(c.value),o.value=!0,c.value=setTimeout(d,1e3)}});async function d(){if(m.value.length<2)return;const i=await n.fetchCity(m.value);h.value=i,o.value=!1,clearTimeout(c.value)}function g(i){i&&(t.value={id:i._id,name:i.name,code:i.code},m.value="")}function y(i){t.value!=null&&(t.value=null,m.value="")}const b=()=>{e.open("city",{modelValue:f,values:h,loading:o,showButtonDelete:a.showButtonDelete},{accept:g,cancel:y})};return(i,B)=>(P(),be(ze,{placeholder:"Не указано",text:t.value&&a.textValue?a.textValue:a.textNotValue,value:t.value?t.value.name:null,onClick:b},null,8,["text","value"]))}};export{Bt as G,xt as _};
